\documentclass[uplatex,paper=a4,fontsize=4.0truemm,jafontsize=4.0truemm,head_space=30.0truemm,baselineskip=8.0truemm,gutter=25.0truemm,oneside,fleqn,hanging_panctuation,open_bracket_pos=nibu_tentsuki,dvipdfmx,jis2004,book,titlepage]{jlreq}
%
\西暦
%\和暦
\NewPageStyle{TopRightNombre}{nombre_position=top-right}
\pagestyle{TopRightNombre}
\usepackage{amsmath,amssymb}
\usepackage[OT1,T2A,X2,OT2,LGR,T1]{fontenc}
\usepackage{textcomp}
\usepackage{lmodern,exscale}
%\usepackage{newtxtext,newtxmath}
%\usepackage{newpxtext,newpxmath}
\usepackage[expert,deluxe]{otf}
\usepackage[noalphabet,unicode,sourcehan-otc]{pxchfon}
\usepackage[prefernoncjk]{pxcjkcat}
\cjkcategory{sym04,sym08,sym09,sym10,sym11,sym12,sym15,sym18,sym19,sym20,brai,sym33}{cjk}
\usepackage[polutonikogreek,esperanto,serbian,bulgarian,ukrainian,russian,greek,french,italian,german,ngerman,dutch,tchinese,schinese,korean,english,japanese]{pxbabel}
\usepackage{soul,dotlessj,myt2aenc,myx2enc,bxokumacro,pxrubrica}
\usepackage{zi4,bxinconsolata,upquote}
\usepackage{mathtools,fouridx}
\usepackage{mathrsfs,bm,myFonts}%myFonts：自作パッケージ＠D:\texlive\texmf-local\tex\latex\local\local\myFonts
\usepackage{bxascmac}
\usepackage{tcolorbox}
\tcbuselibrary{most}
\usepackage[version=4]{mhchem}
\usepackage{XyMTeX,chemfig}
\usepackage[bookmarksnumbered=true,bookmarksopen=true,hidelinks,breaklinks=true,pdfusetitle]{hyperref}
\usepackage[bigcode]{pxjahyper}
\renewcommand{\UrlBreaks}{\do\:\do\/\do\-\do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j\do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t\do\u\do\v\do\w\do\x\do\y\do\z\do\A\do\B\do\C\do\D\do\E\do\F\do\G\do\H\do\I\do\J\do\K\do\L\do\M\do\N\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V\do\W\do\X\do\Y\do\Z}
\usepackage{ltablex}
\usepackage{graphicx,xcolor}
\usepackage{tikz}
\usetikzlibrary{patterns,intersections,calc,arrows,decorations,angles,datavisualization,datavisualization.formats.functions,datavisualization.polar,automata}
\usepackage{listings,plistings}
\lstset{%
	language={C},%
	basicstyle={\normalsize\ttfamily},%
	identifierstyle={\normalsize},%
	commentstyle={\normalsize\ttfamily\bfseries\color[rgb]{0,0.4,0}},%
	keywordstyle={\normalsize\ttfamily\bfseries\color[rgb]{0,0,1}},%
	ndkeywordstyle={\normalsize},%
	stringstyle={\normalsize\ttfamily\bfseries\color[rgb]{0.4,0,0.4}},%
	frame={tb},%
	breaklines=true,%
	columns=[l]{fullflexible},%
	showstringspaces=false,%
	keepspaces=true,%
	numbers=left,%
	xrightmargin=0zw,%
	xleftmargin=0zw,%
	numberstyle={\scriptsize},%
	stepnumber=1,%
	numbersep=1zw,%
	lineskip=-0.4zw%
}
\usepackage[tone,extra]{tipa}
\usepackage{tipx}
\usepackage{siunitx}
\usepackage[at]{easylist}
\usepackage{amsthm}
\newtheoremstyle{mystyle}{\baselineskip}{\baselineskip}{\rmfamily}{}{\sffamily}{}{\newline}{}%Name, Space above, Space below, Body font, Indent amount, Theorem head font, Punctuation after theorem head, Space after theorem head: ' ' or \newline, Theorem head spec (can be left empty--meaning `normal')
\theoremstyle{mystyle}
\newtheorem{Axiom}{公理}[section]
\newtheorem{Definition}{定義}[section]
\newtheorem{Proposition}{命題}[section]
\newtheorem{Theorem}{定理}[section]
\newtheorem{Lemma}{補題}[section]
\newtheorem{Corollary}{系}[section]
\newtheorem{Conjecture}{予想}[section]
\renewcommand{\proofname}{\hspace{0.4zw}\textsf{証明}}
\renewcommand{\qedsymbol}{\(\blacksquare\)}
\makeatletter
	\renewenvironment{proof}[1][\proofname]{%
		\pushQED{\qed}%
		\normalfont%
		\trivlist%
		\item[#1]\ignorespaces\leavevmode\\
	}
	{%
		\popQED\endtrivlist\@endpefalse
	}%
	\def\delete#1from#2{% 
		\def\reserved@a{#1}% 
		\def\reserved@c{}% 
		\def\@elt##1{% 
			\def\reserved@b{##1}% 
			\ifx\reserved@a\reserved@b 
			\else 
				\@cons\reserved@c{{##1}}% 
			\fi
		}% 
		\csname cl@#2\endcsname 
		\expandafter\let\csname cl@#2\endcsname\reserved@c 
		\let\@elt\relax
	}%
\makeatother
\delete{footnote}from{chapter}
\usepackage{comment,csquotes}
\makeatletter
	\renewcommand{\theequation}{\thesection.\arabic{equation}}
	\@addtoreset{equation}{section}
	\renewcommand{\thetable}{\thesection.\arabic{table}}
	\@addtoreset{table}{section}
	\renewcommand{\thefigure}{\thesection.\arabic{figure}}
	\@addtoreset{figure}{section}
	\renewcommand{\thefootnote}{\arabic{footnote}}
	\AtBeginDocument{\renewcommand{\thelstlisting}{\thesection.\arabic{lstlisting}}}
	\@addtoreset{lstlisting}{section}
\makeatother
\newcolumntype{C}{>{\centering\arraybackslash}X}
\newcolumntype{L}{>{\raggedright\arraybackslash}X}
\newcolumntype{R}{>{\raggedleft\arraybackslash}X}
\allowdisplaybreaks[4]
%
\newcommand{\zwspace}{\hspace{1zw}\relax}
\renewcommand{\lstlistingname}{プログラム}
\newcommand{\figureinput}[4]{\begin{figure}[tbp]\centering\includegraphics[#1]{#2}\caption{#3．}\label{fig:#4}\end{figure}}
\newcommand{\tableinput}[4]{\begin{table}[tbp]\centering\caption{#3．}\label{tab:#4}\begin{tabular}{#1}#2\end{tabular}\end{table}}
\newcommand{\mathdisplaystyle}[1]{\(\displaystyle{#1}\)}
\newcommand{\Reference}[1]{\mathdisplaystyle{\ref{#1}}}
\newcommand{\Citation}[1]{\mathdisplaystyle{\cite{#1}}}
\newcommand{\Equationreference}[1]{\mathdisplaystyle{\parentheses{\ref{#1}}}}
\newcommand{\negativevalue}[1]{{-#1}}
\newcommand{\positivevalue}[1]{{+#1}}
\newcommand{\plusminusvalue}[1]{{\pm#1}}
\newcommand{\minusplusvalue}[1]{{\mp#1}}
\newcommand{\fraction}[2]{\displaystyle{\frac{\displaystyle{#1}}{\displaystyle{#2}}}}
\newcommand{\mathcomma}{\mathpunct{,\,}}
\newcommand{\mathsemicolon}{\mathpunct{;\,}}
\newcommand{\commas}{\mathpunct{\mathcomma\dotsc\mathcomma}}
\newcommand{\definitionequal}{\mathrel{:=}}
\newcommand{\definitionarrow}{\mathrel{\overset{\textrm{def}}{\Longleftrightarrow}}}
\newcommand{\ifarrow}{\mathrel{\Longleftarrow}}
\newcommand{\onlyifarrow}{\mathrel{\Longrightarrow}}
\newcommand{\ifandonlyifarrow}{\mathrel{\Longleftrightarrow}}
\newcommand{\shortfunction}[5]{\displaystyle{\mathord{#1}\colon#2\to#3\mathsemicolon#4\mapsto#5}}
\newcommand{\strutroot}[2]{\sqrt[#1]{\mathstrut{#2}}}
\newcommand{\alephnull}{\aleph_0}
\newcommand{\delivative}[1]{\displaystyle{\,d#1}}
\newcommand{\inversed}[1]{{#1}^{\negativevalue{1}}}
\newcommand{\parentheses}[1]{\left(#1\right)}
\newcommand{\braces}[1]{\left\{#1\right\}}
\newcommand{\squarebrackets}[1]{\left[#1\right]}
\newcommand{\mediumverticalline}[2]{#1\mathrel{}\middle|\mathrel{}#2}
\newcommand{\absolute}[1]{\left\lvert#1\right\rvert}
\newcommand{\norm}[2]{{\left\lVert#1\right\rVert}_{#2}}
\newcommand{\anglebrackets}[1]{\left\langle#1\right\rangle}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\Diracbra}[1]{\left\langle#1\right\rvert}
\newcommand{\Diracket}[1]{\left\lvert#1\right\rangle}
\newcommand{\innerproduct}[2]{\anglebrackets{#1\mathcomma#2}}
\newcommand{\leftclosedrightopen}[2]{\left[{#1\mathcomma#2}\right)}
\newcommand{\leftopenrightclosed}[2]{\left({#1\mathcomma#2}\right]}
\newcommand{\gradient}[2]{\nabla_{#1}{#2}}
\newcommand{\divergence}[1]{\nabla\cdot#1}
\newcommand{\rotation}[1]{\nabla\times#1}
\DeclareMathOperator{\operatorgrad}{grad}
\DeclareMathOperator{\operatordiv}{div}
\DeclareMathOperator{\operatorrot}{rot}
\DeclareMathOperator{\realpart}{Re}
\DeclareMathOperator{\imaginarypart}{Im}
\DeclareMathOperator{\cardinality}{card}
\newcommand{\easymatrix}[1]{\mathord{\begin{pmatrix}#1\end{pmatrix}}}
\newcommand{\transpose}[1]{\fourIdx{t\!}{}{}{}{#1}}
\newcommand{\transposedmatrix}[1]{\transpose{\easymatrix{#1}}}
\newcommand{\combination}[2]{\fourIdx{}{#1}{}{#2}{\mathrm{C}}}
\newcommand{\permutation}[2]{\fourIdx{}{#1}{}{#2}{\mathrm{P}}}
\newcommand{\chemicalelement}[3]{\ce{_{#1}^{#2}#3}}
\title{\vspace{-25truemm}\Huge{SVMとCIELUV色空間を用いた1型2色覚，2型2色覚の色の見え方の分類}\vspace{55truemm}}
\author{\huge{坂井~法仁}}
\date{\LARGE{令和2年2月}\\ \vspace{30truemm}\LARGE{九州大学理学部物理学科\\ 情報理学コース}}
\begin{document}
	\urlstyle{rm}
	\interfootnotelinepenalty=10000000
	\maketitle
	\pagenumbering{roman}
	\tableofcontents
	%\listoftables
	%\listoffigures
	\clearpage
	\setcounter{page}{1}
	\pagenumbering{arabic}
	\chapter{序論}
		\section{色覚異常について}
			世の中には，X染色体がトリガーとなる先天的な色盲者\cite{Okabe2002a}，色弱者\cite{Sunaga2017}や加齢によって色の見え方が後天的に変化する人\cite{Kuriki2000}がいる．

			前者の場合，多くの人は視細胞にL錐体（L cone），M錐体（M cone），S錐体（S cone），杆体（rod）の4種類を持っているが，色盲者は1種類以上の錐体細胞（cone cell）が先天的に欠損していて\footnote{錐体の数は少ないが完全に欠損している訳ではないという人もいて，こちらは軽度であれば色弱に含めることがある．}，色弱者は欠損は無いものの刺激の光の波長に対する錐体細胞の感度分布が異なっている．
			これらを合わせると，国内では男性の約5\%，女性の約0.2\%が色盲者，色弱者である\cite[p.~4]{doctors2019}．
			L錐体が欠損している色盲を1型2色覚（protanopia），M錐体が欠損している色盲を2型2色覚（deuteranopia），S錐体が欠損している色盲を3型2色覚（tritanopia）という\footnote{色盲者を表すときは接尾辞が-iaから-eに変化する．\textit{E.g.} protanope．}．
			先天色覚異常の大多数は1型2色覚と2型2色覚である\cite[p.~9]{doctors2014}．
			\begin{figure}[tbp]
				\centering
				\begin{tabular}{c}
					\begin{minipage}{0.4\hsize}
						\centering
						\includegraphics[width=5truecm]{D:/a/figs/56.PNG}\caption{可視光のスペクトル画像（波長域：380 nm--780 nm，分析・計測・測位用 アート開発 Labs\protect\cite{Artlabs2019}より引用）}\label{fig:Cspect}
					\end{minipage}
					\begin{minipage}{0.1\hsize}
						\vspace{1truemm}
					\end{minipage}
					\begin{minipage}{0.4\hsize}
						\centering
						\includegraphics[width=5truecm]{D:/a/figs/prot_imagej_100_56.png}\caption{図\ref{fig:Cspect}の1型2色覚の見え方のシミュレーション（Colorblind Proを使用，以下同様）}\label{fig:Pspect}
					\end{minipage} \\
					\begin{minipage}{0.06\hsize}
						\vspace{10truemm}
					\end{minipage} \\
					\begin{minipage}{0.4\hsize}
						\centering
						\includegraphics[width=5truecm]{D:/a/figs/deut_imagej_100_56.png}\caption{図\ref{fig:Cspect}の2型2色覚の見え方のシミュレーション}\label{fig:Dspect}
					\end{minipage}
					\begin{minipage}{0.1\hsize}
						\vspace{1truemm}
					\end{minipage}
					\begin{minipage}{0.4\hsize}
						\centering
						\includegraphics[width=5truecm]{D:/a/figs/trit_imagej_100_56.png}\caption{図\ref{fig:Cspect}の3型2色覚の見え方のシミュレーション}\label{fig:Tspect}
					\end{minipage}
				\end{tabular}
			\end{figure}
			図\Reference{fig:Cspect}--\Reference{fig:Tspect}は可視光のスペクトル画像とそれに1型2色覚，2型2色覚，3型2色覚のシミュレーションを実行した結果である．
			1型2色覚と2型2色覚の色の見え方は似ている．
			図\Reference{fig:fundament}は国際照明委員会（Commission Internationale de l'Éclairage；CIE）が2015年に制定した2\textdegree 視野のCIE2015\mathdisplaystyle{XYZ}表色系（CIE2015\mathdisplaystyle{XYZ} color system）から導出される正規化錐体分光感度（normalized cone fundamental）である．
			\figureinput{width=\linewidth}{D:/a/figs/ConeFundamental.png}{CIE2015\mathdisplaystyle{\bm{XYZ}}表色系（2\textdegree 視野）から導出される正規化錐体分光感度}{fundament}
			L錐体とM錐体の錐体分光感度の分布は近くにあり，3種類の錐体の応答値を3次元空間にプロットすることで構成される\mathdisplaystyle{LMS}色空間（\mathdisplaystyle{LMS} color space）は\mathdisplaystyle{L}軸の基底ベクトルと\mathdisplaystyle{M}軸の基底ベクトルが近い向きを向いている斜交座標系になっていて，1型2色覚に対応する平面\mathdisplaystyle{L=0}と2型2色覚に対応する平面\mathdisplaystyle{M=0}も近い．
			1型2色覚と2型2色覚の色の見え方の類似性はここからきていると考えられる．

			加齢による色の見え方の変化は核白内障（nuclear cataract）に伴う水晶体（crystalline lens）の黄変によって光が錐体に届く前にスペクトルが歪められることによって起こる．
			短波長の光が吸収されやすい為，青紫や青緑等の青系統の色の識別が難しくなる他，液体，炎や電光掲示板が見え辛くなる\cite{Ishihara1998}．
		\section{カラーユニバーサルデザイン，色覚シミュレーションについて}
			色盲者や色弱者でも識別しやすい色の組み合わせを用いて情報伝達を行うカラーユニバーサルデザインが進められている．
			多くの色覚異常当事者の協力の下でカラーユニバーサルデザイン配色が考案される（\cite[pp.~1091--1099]{Okabe2002c}，\cite{cudo2018}等），どんな人でも適切に識別できる組み合わせのチョークが開発される\cite{Rikagaku2020}，JIS Z 9013（図記号―安全色及び安全標識―安全色の色度座標の範囲及び測定方法）が改正される\cite{Nakano2018}等である．
			また，Brattelらが1型2色覚，2型2色覚，3型2色覚の色の見え方をシミュレートするアルゴリズムを発表\cite{Brettel1997}してからは，少しずつ改良を加える形で様々なシミュレータが作られ，3色覚者でも彼らの見え方を疑似体験できるようになった．

			しかし，Brattelらのアルゴリズムを零から実装すると，前処理として可視光波長域上での数値積分を3回，3次正方行列の逆行列の計算を1回，3次元ベクトルの外積を2回実行し，更に各色毎に3次正方行列と3次元ベクトルの乗算を3回ずつ行わなければならず，24 bitの\mathdisplaystyle{RGB}色空間で\mathdisplaystyle{2^{24}}色\footnote{\mathdisplaystyle{2^{24}=16{,}777{,}216}．}全てに亘って変換を掛けながら当事者と見え方を摺り合わせていくのは大変な時間を要する．
			その上，実装や改良に際して色彩学や生理学に関する必要な知識が多く，専門外の人が取り組みにくくなっていると言わざるを得ない．
		\section{本稿の目的}
			そこで本稿では，人口が比較的多く，色の見え方が類似している1型2色覚，2型2色覚に着目する．
			本学芸術工学研究院デザイン人間科学部門の須長正治准教授が研究されているnatural color system（NCS）に関する色のデータセット\footnote{本来は1950色であるが，手元に届いた時点でS2075-Y60RとS3050-R20Bが同梱されていなかったという．従って，以下で「NCS」と言う時はこれらを除いた1948色を指す．}を用いて，NCSのAdobe\mathdisplaystyle{RGB}座標，サポートベクトルマシン（support vector machine；SVM），Gauß過程（Gaussian process；GP）によるBayes最適化（Bayesian optimization）でNCSの色を1型2色覚，2型2色覚それぞれの色の見え方に分類できることを示す．
			更に，それで得たパラメータと1948色のNCS全体を用いて，Adobe\mathdisplaystyle{RGB}色空間上の非負格子点（\mathdisplaystyle{2^{24}}色）全てにおける各2色覚での色の見え方を予測する．
			各非負格子点の正解ラベルが未知であることを踏まえ，色差（color difference）\footnote{2つの色の区別しやすさに関する定量的指標．}が定義されている均等色空間（uniform color space）の一つ，CIE1976\mathdisplaystyle{L^\ast u^\ast v^\ast}色空間（CIELUV色空間）\cite[p.~64]{Yaguchi2017b}に座標変換して予測ラベルの代表色との色差による精度評価も行う．
	\chapter{先行研究}
		HuangらはBrattelらのアルゴリズムを基に，「変換の自然さ」を維持しながら色差を保つ1型2色覚，2型2色覚への色変換を提案している\cite{Huang2007}．
		「変換の自然さ」を維持する為に，（１）変換前後で輝度（luminance）を変えない，（２）変換前で同じ色相（hue）を持つ2色は変換後も同じ色相を持つ，（３）変換前で同じ彩度（saturation）を持つ2色は変換後も同じ彩度を持つように，CIE1976\mathdisplaystyle{L^\ast a^\ast b^\ast}色空間（CIELAB色空間）上の\mathdisplaystyle{a^\ast b^\ast}平面を回転する．
		その回転角は，変換前の色差と合成変換（\mathdisplaystyle{\textrm{Brattel}\circ\textrm{Huang}}）後の色差の差の平方和の誤差関数と（\emph{一旦省略}）．
	\chapter{実験と結果}
		\section{データセットの説明}
			本稿で使用するデータセットはNCS 1948色のAdobe\mathdisplaystyle{RGB}座標（整数値への四捨五入前，但し，計算値が負になった物は0にしてある），及び，1型2色覚，2型2色覚それぞれについて各色を43クラスでラベリングした結果である．
			データセットの概要を表\Reference{tab:dataset1}，表\Reference{tab:dataset2}に示す．
			以降，列名に表れる「P」は1型2色覚，「D」は2型2色覚のことを意味するものとする．
			\tableinput{l|lrrrrrr}{ & NCS代表色 & Adobe\(R\) & Adobe\(G\) & Adobe\(B\) & \(\#\textrm{P}\) & \(\#\textrm{D}\) & \(\#\parentheses{\textrm{P}\cap\textrm{D}}\) \\ \hline
				Wt & S0500-N & 235.6629 & 234.7774 & 231.2127 & 23 & 20 & 12 \\
				plGy & S2000-N & 195.6736 & 194.7891 & 191.3287 & 40 & 36 & 20 \\
				ltGy & S3500-N & 163.9940 & 162.9809 & 160.8466 & 65 & 58 & 31 \\
				mdGy & S5000-N & 134.1809 & 134.1703 & 134.2813 & 70 & 61 & 32 \\
				dkGy & S7500-N & 86.9541 & 86.8106 & 86.6477 & 70 & 65 & 28 \\
				Bk & S9000-N & 47.2956 & 47.8310 & 49.5712 & 13 & 11 & 9 \\
				y-Wt & S0507-Y & 239.5724 & 235.2736 & 209.1030 & 74 & 70 & 63 \\
				y-plGy & S2005-Y & 197.0129 & 194.0007 & 177.4013 & 94 & 102 & 75 \\
				y-ltGy & S2502-Y & 184.4848 & 183.2185 & 174.1260 & 77 & 73 & 44 \\
				y-mdGy & S5010-G90Y & 133.8320 & 129.6478 & 109.4358 & 91 & 74 & 41 \\
				y-dkGy & S8010-G90Y & 72.0204 & 68.0469 & 54.3256 & 75 & 58 & 31 \\
				vp-Y & S1020-Y & 225.2654 & 214.4556 & 163.4146 & 64 & 62 & 53 \\
				lg-Y & S2020-Y & 196.4906 & 186.1061 & 141.9709 & 76 & 85 & 54 \\
				mg-Y & S4020-Y & 150.4791 & 138.6121 & 101.8951 & 103 & 104 & 55 \\
				dg-Y & S6020-Y & 111.1297 & 99.3336 & 69.0294 & 80 & 82 & 39 \\
				vd-Y & S7020-G90Y & 82.5625 & 75.5720 & 51.5917 & 17 & 13 & 5 \\
				pl-Y & S0540-Y & 243.6672 & 225.0307 & 135.9848 & 31 & 29 & 23 \\
				sf-Y & S2040-Y & 198.0241 & 178.9121 & 103.2851 & 73 & 78 & 46 \\
				dl-Y & S3560-Y & 150.4791 & 138.6121 & 101.8951 & 126 & 143 & 83 \\
				dk-Y & S5040-Y & 122.8045 & 104.0727 & 52.9174 & 52 & 51 & 25 \\
				lt-Y & S0560-Y & 238.1361 & 209.5451 & 87.7278 & 26 & 23 & 20 \\
				st-Y & S1080-Y & 214.4635 & 182.5300 & 0.0000 & 47 & 53 & 32 \\
				dp-Y & S2070-Y & 185.2438 & 157.4583 & 42.1169 & 30 & 39 & 15 \\
				vv-Y & S0580-Y & 238.6570 & 204.8486 & 0.0000 & 1 & 3 & 1 \\
				b-Wt & S0505-R90B & 224.6986 & 229.3882 & 233.0692 & 24 & 21 & 16 \\
				b-plGy & S0907-R90B & 211.9650 & 218.4358 & 224.1348 & 45 & 46 & 23 \\
				b-ltGy & S3005-R80B & 164.4555 & 168.6782 & 174.3469 & 34 & 35 & 12 \\
				b-mdGy & S6005-R80B & 103.6745 & 107.1785 & 114.0519 & 44 & 52 & 15 \\
				b-dkGy & S7010-R90B & 73.8830 & 81.1664 & 91.7979 & 31 & 35 & 9}{データセットの概要}{dataset1}
			\tableinput{l|lrrrrrr}{ & NCS代表色 & Adobe\(R\) & Adobe\(G\) & Adobe\(B\) & \(\#\textrm{P}\) & \(\#\textrm{D}\) & \(\#\parentheses{\text{P}\cap\text{D}}\) \\ \hline
				b-Bk & S8010-R50B & 57.8759 & 50.8047 & 62.8086 & 3 & 1 & 1 \\
				vp-pB & S0515-R90B & 204.6848 & 217.5930 & 230.3978 & 25 & 29 & 18 \\
				lg-pB & S1515-R90B & 179.8229 & 192.8497 & 206.1419 & 38 & 36 & 16 \\
				mg-pB & S4010-R90B & 132.2837 & 140.6962 & 150.5120 & 35 & 37 & 12 \\
				dg-pB & S5020-B & 93.2631 & 110.9807 & 127.1168 & 29 & 34 & 10 \\
				vd-pB & S8010-R90B & 47.3202 & 54.5546 & 66.1253 & 12 & 9 & 5 \\
				pl-pB & S0530-R90B & 174.2376 & 200.7052 & 226.8996 & 21 & 24 & 17 \\
				sf-pB & S2030-R90B & 140.7151 & 164.1106 & 190.6701 & 36 & 40 & 18 \\
				dl-pB & S4030-R90B & 100.1698 & 120.9944 & 149.8754 & 60 & 67 & 40 \\
				dk-pB & S6030-R90B & 50.6591 & 70.7194 & 97.8596 & 17 & 16 & 8 \\
				lt-pB & S1050-R90B & 122.1359 & 165.7693 & 217.2947 & 20 & 19 & 15 \\
				st-pB & S4040-R90B & 78.4195 & 105.1236 & 145.6135 & 16 & 15 & 6 \\
				dp-pB & S4550-R90B & 25.5495 & 68.4164 & 115.8239 & 28 & 24 & 21 \\
				vv-pB & S3060-R90B & 48.3133 & 96.8561 & 157.3008 & 12 & 15 & 8 \\ \hline
				合計 &  &  &  &  & 1948 & 1948 & 1107}{データセットの概要\zwspace 続き}{dataset2}
			NCSはいずれも物体色である為，光源色であるAdobe\mathdisplaystyle{RGB}色空間への座標変換の前提として光源と\mathdisplaystyle{XYZ}表色系の仮定が要求される．
			本データセットでは，光源にCIE標準光源D65（CIE standard illuminant D65）を，\mathdisplaystyle{XYZ}表色系にCIE1931\mathdisplaystyle{XYZ}表色系（2\textdegree 視野）\cite[pp.~28--30]{Yaguchi2017a}を採用している．
			城戸らの研究（\cite[図1]{Kido2017}，\cite[図1]{Kido2018}）に倣って各代表色を黄青―明度平面に置くと図\Reference{fig:YB}のようになる\footnote{本来のクラス数は44であるが，y-Bkに属する色がNCSに無かったので，表\Reference{tab:dataset1}，表\Reference{tab:dataset2}ではそれを無視し，図\Reference{fig:YB}ではそれを\#000000で塗っている．}．
			周囲の数字はMunsell表色系上の5Y-5PB平面における彩度（Munsell表色系ではchromaという），明度（lightness，Munsell表色系ではvalueという）に対応する．
			\figureinput{width=\linewidth}{D:/a/figs/YB.png}{黄青―明度平面}{YB}
		\section{実験1}
			\subsection{手続き}
				実験1では，本データセットを1型2色覚，2型2色覚の色の見え方クラスにそれぞれ分類する分類器を作成する．
				外から与えた乱数シードを基にデータセットを80/20に分割する．
				その上で，訓練データに対してSVMの分類器を導入する．
				カーネルはradial basis function kernelで固定し，\texttt{sklearn{.}svm{.}SVC}のハイパーパラメータ\mathdisplaystyle{\gamma}，\mathdisplaystyle{C}，\textit{class\_weight}を学習する\footnote{これ以外のパラメータはscikit-learn 0.22.1の\texttt{sklearn{.}svm{.}SVC}の初期設定のままである．}．
				ハイパーパラメータの推定にGPによるBayes最適化を用いる．
				同じ乱数シードで訓練データを更に5分割し，
				\begin{align}
					&\gamma\in\squarebrackets{2^\negativevalue{20},2^{20}}\quad\parentheses{\textrm{但し，対数一様分布（log-uniform distribution）}}\textrm{，}\label{eq:gamma}\\
					&C\in\squarebrackets{2^\negativevalue{20},2^{20}}\quad\parentheses{\textrm{但し，対数一様分布}}\textrm{，}\label{eq:C}\\
					&\textit{class\_weight}\in\braces{\textit{None},\textrm{``balanced''}}\label{eq:classweight}
				\end{align}
				という条件の下，分割された訓練データそれぞれの正解率（accuracy）の平均値を最大にするパラメータを推定する．
				チューニングに用いる\texttt{skopt{.}gp\_minimize}のパラメータについては\mathdisplaystyle{\textit{acq\_func}=\textrm{``EI''}}，\mathdisplaystyle{\textit{n\_calls}=200}で設定する\footnote{これ以外のパラメータはscikit-optimize 0.5.2の\texttt{\texttt{skopt{.}gp\_minimize}}の初期設定のままである．}．
			\subsection{結果}
				分割の乱数シードは88058390である．
				実験1の結果を表\Reference{tab:result1}に纏めた．
				\tableinput{l|rr}{ & P & D \\ \hline
					\mathdisplaystyle{\gamma} & \mathdisplaystyle{1.0830\times{10}^{-6}} & \mathdisplaystyle{2.7812\times{10}^{-6}} \\
					\mathdisplaystyle{C} & \mathdisplaystyle{1.0486\times{10}^6} & \mathdisplaystyle{1.0412\times{10}^6} \\
					\textit{class\_weight} & \textit{None} & ``balanced'' \\
					正解率（訓練データ） & 0.9936 & 0.9929 \\
					正解率（テストデータ） & 0.9077 & 0.9154}{実験1の結果の数値表}{result1}

				2型2色覚は式\Equationreference{eq:gamma}--\Equationreference{eq:classweight}右辺内部で収束している．
				しかし，1型2色覚は\mathdisplaystyle{C=1.0486\times10^6\gtrsim2^{20}}より式\Equationreference{eq:C}右辺の上限に一致してしまっている．
				正解率から推測するに，1型2色覚の最適な\mathdisplaystyle{C}は\mathdisplaystyle{2^{20}}よりもやや大きいと考えられる．

				テストデータにおける混同行列（confusion matrix）を図\Reference{fig:conP}--\Reference{fig:conD1}に示す．
				上段は各々の絶対数，下段は正解クラス別に割合を取った物である．
				\begin{figure}[tbp]
					\centering
					\begin{tabular}{c}
						\begin{minipage}{0.4\hsize}
							\centering
							\includegraphics[width=5truecm]{D:/a/figs/Pconmat.png}\caption{1型2色覚の混同行列}\label{fig:conP}
						\end{minipage}
						\begin{minipage}{0.1\hsize}
							\vspace{1truemm}
						\end{minipage}
						\begin{minipage}{0.4\hsize}
							\centering
							\includegraphics[width=5truecm]{D:/a/figs/Dconmat.png}\caption{2型2色覚の混同行列}\label{fig:conD}
						\end{minipage} \\
						\begin{minipage}{0.06\hsize}
							\vspace{10truemm}
						\end{minipage} \\
						\begin{minipage}{0.4\hsize}
							\centering
							\includegraphics[width=5truecm]{D:/a/figs/Pconmat2.png}\caption{図\ref{fig:conP}の正解クラス別割合}\label{fig:conP1}
						\end{minipage}
						\begin{minipage}{0.1\hsize}
							\vspace{1truemm}
						\end{minipage}
						\begin{minipage}{0.4\hsize}
							\centering
							\includegraphics[width=5truecm]{D:/a/figs/Dconmat2.png}\caption{図\ref{fig:conD}の正解クラス別割合}\label{fig:conD1}
						\end{minipage}
					\end{tabular}
				\end{figure}
				図\Reference{fig:conP1}，図\Reference{fig:conD1}で対角成分から左または右に4列離れた成分が仄明るく光っている様子が見られる．
				これは，図\Reference{fig:YB}で明度が等しく彩度方向で隣接しているクラス同士の関係であり，Adobe\mathdisplaystyle{RGB}色空間とMunsell表色系という異なる空間ではあるものの，この関係にあるクラスが近くにあった為，誤分類が生じたと考えられる．

				訓練データでの正解率と混同行列を踏まえると，1型2色覚，2型2色覚のいずれもSVM＋Bayes最適化で十分学習できたと言えるであろう．
		\section{実験2}
			\subsection{手続き}
				実験2では，1948色のデータセット全てと実験1で得たパラメータを用いて，24 bit Adobe\mathdisplaystyle{RGB}色空間上の非負格子点（\mathdisplaystyle{2^{24}}色）全てにおける1型2色覚，2型2色覚での色の見え方を予測する．
				各色は正解ラベルを2つずつ持っているはずであるが我々には未知であり，予測の精度を検証できない．
				しかし，実験1の結果から1型2色覚，2型2色覚いずれにおいても1割程度の誤分類が発生することは予想できる．
				そこで，均等色空間の一つであるCIELUV色空間に座標変換して議論する．
				均等色空間はCIELUVやCIELABの他にCIEDE2000やCAM02-UCS等様々ある\cite{Yaguchi2017b}が，CIELUVは変換が比較的単純である為，計算速度が求められる際には役立つ色空間である．
				一方で，CIELUVやCIELABは新しい均等色空間と比べて知覚の均一性が弱いという欠点がある\cite[p.~10]{Robertson1977}．

				まず，表\Reference{tab:dataset1}，表\Reference{tab:dataset2}の各代表色を，CIE1931\mathdisplaystyle{XYZ}表色系，\mathdisplaystyle{LMS}色空間を経由して1型2色覚，2型2色覚の\mathdisplaystyle{LMS}に写し，再度CIE1931\mathdisplaystyle{XYZ}を経由してCIELUVに座標変換する．
				任意の2色\mathdisplaystyle{\boldc_\alpha}，\mathdisplaystyle{\boldc_\beta}間の色差\mathdisplaystyle{\greekDELTA E^{L^\ast u^\ast v^\ast}\parentheses{\boldc_\alpha,\boldc_\beta}}はCIELUV上のEuclid距離で
				\begin{equation*}
					\greekDELTA E\parentheses{\boldc_\alpha,\boldc_\beta}=\norm{\boldc_\beta^{L^\ast u^\ast v^\ast}-\boldc_\alpha^{L^\ast u^\ast v^\ast}}{2}
				\end{equation*}
				と表現できる．
				これを用いて，43色における距離行列を計算すると図\Reference{fig:Pmatrix}，図\Reference{fig:Dmatrix}を得る．
				\begin{figure}[tbp]
					\centering
					\begin{tabular}{c}
						\begin{minipage}{0.4\hsize}
							\centering
							\includegraphics[width=5truecm]{D:/a/figs/Pmatrix.png}\caption{1型2色覚における代表色の距離行列}\label{fig:Pmatrix}
						\end{minipage}
						\begin{minipage}{0.1\hsize}
							\vspace{1truemm}
						\end{minipage}
						\begin{minipage}{0.4\hsize}
							\centering
							\includegraphics[width=5truecm]{D:/a/figs/Dmatrix.png}\caption{2型2色覚における代表色の距離行列}\label{fig:Dmatrix}
						\end{minipage}
					\end{tabular}
				\end{figure}
				Munsell表色系（図\Reference{fig:YB}）で近い位置関係にあった対はCIELUV色空間上でも比較的近くにあることが分かる．

				次に，各クラス\mathdisplaystyle{\parentheses{C_i}_{i=1}^{43}}について代表色を\mathdisplaystyle{\hat{\boldc}_i\in C_i}とし，自分自身を除いて最も近い代表色\mathdisplaystyle{\hat{\boldc}_{\tilde{j}\parentheses{i}}}との色差\mathdisplaystyle{\greekDELTA E_i^{L^\ast u^\ast v^\ast}}を距離行列から
				\begin{align*}
					&\greekDELTA E_i=\min{\braces{\mediumverticalline{\greekDELTA E^{L^\ast u^\ast v^\ast}\parentheses{\hat{\boldc}_i,\hat{\boldc}_j}}{i\neq j}}}\textrm{，}\\
					&\tilde{j}\parentheses{i}\in\operatorname*{arg\,min}_{j\neq i}{\greekDELTA E^{L^\ast u^\ast v^\ast}\parentheses{\hat{\boldc}_i,\hat{\boldc}_j}}
				\end{align*}
				で求め，代表色\mathdisplaystyle{\hat{\boldc}_i^{L^\ast u^\ast v^\ast}}を中心とする半径が\mathdisplaystyle{\greekDELTA E_i}である開球\mathdisplaystyle{B\parentheses{\hat{\boldc}_i^{L^\ast u^\ast v^\ast},\greekDELTA E_i}}と，半径がその半分である開球\mathdisplaystyle{B\parentheses{\hat{\boldc}_i^{L^\ast u^\ast v^\ast},\greekDELTA E_i/2}}を考える．
				以下，便宜的に前者を弱採択域，後者を強採択域と呼ぶ．
	\chapter{結論}
	\clearpage
	\addcontentsline{toc}{chapter}{\refname}
	\bibliography{ref}
	\bibliographystyle{Cpjeconunsrt}
	%\bibliographystyle{junsrt}
	%\bibliographystyle{IEEEtranS}
\end{document}